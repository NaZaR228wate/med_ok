<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–í—ñ–¥–≥—É–∫–∏ ‚Äî med_ok</title>

  <!-- Canonical + robots -->
  <link rel="canonical" href="https://nazar228wate.github.io/med_ok/reviews.html" />
  <meta name="robots" content="index,follow" />

  <!-- Base SEO -->
  <meta name="description" content="–í—ñ–¥–≥—É–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –ø—Ä–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ med_ok. –ß–∏—Ç–∞–π—Ç–µ —ñ—Å—Ç–æ—Ä—ñ—ó –Ω–∞—à–∏—Ö –ø–æ–∫—É–ø—Ü—ñ–≤ —Ç–∞ –ø–æ–¥—ñ–ª—ñ—Ç—å—Å—è –≤–ª–∞—Å–Ω–æ—é –¥—É–º–∫–æ—é!">
  <meta name="keywords" content="–º–µ–¥ –≤—ñ–¥–≥—É–∫–∏, –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥, –ø–∞—Å—ñ–∫–∞ –ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å, –∫—É–ø–∏—Ç–∏ –º–µ–¥ –æ–Ω–ª–∞–π–Ω, –≤—ñ–¥–≥—É–∫–∏ –ø–æ–∫—É–ø—Ü—ñ–≤ –º–µ–¥">

  <!-- Open Graph -->
  <meta property="og:title" content="–í—ñ–¥–≥—É–∫–∏ ‚Äî med_ok">
  <meta property="og:description" content="–î—ñ–∑–Ω–∞–π—Ç–µ—Å—è, —â–æ –≥–æ–≤–æ—Ä—è—Ç—å –∫–ª—ñ—î–Ω—Ç–∏ –ø—Ä–æ –Ω–∞—à –º–µ–¥, —Ç–∞ –∑–∞–ª–∏—à—Ç–µ —Å–≤—ñ–π –≤—ñ–¥–≥—É–∫.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://nazar228wate.github.io/med_ok/reviews.html">
  <meta property="og:image" content="https://nazar228wate.github.io/med_ok/assets/prod-mixed.webp">

  <!-- Favicons / PWA -->
  <link rel="icon" href="assets/medok-wordmark.png">
  <meta name="theme-color" content="#087B04">
  <link rel="manifest" href="manifest.webmanifest">

  <!-- Preconnect –¥–æ API -->
  <link rel="preconnect" href="https://medok-proxy.veter010709.workers.dev" crossorigin>

  <!-- CSS -->
  <link rel="stylesheet" href="styles.css?v=12">
<link rel="canonical" href="https://nazar228wate.github.io/med_ok/reviews.html" />
<meta property="og:url" content="https://nazar228wate.github.io/med_ok/reviews.html" />
<meta property="og:image" content="https://nazar228wate.github.io/med_ok/assets/prod-mixed.webp" />

  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"–í—ñ–¥–≥—É–∫–∏ ‚Äî med_ok",
    "url":"https://nazar228wate.github.io/med_ok/reviews.html",
    "description":"–í—ñ–¥–≥—É–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –ø—Ä–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ med_ok."
  }
  </script>
</head>
<body>
<a class="visually-hidden" href="#main">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É</a>

<header>
  <div class="container nav">
    <a href="index.html" class="brand" aria-label="med_ok">
      <img class="brand-wordmark" src="assets/medok-wordmark.png" alt="med_ok" width="140" height="40">
    </a>

    <nav id="primary-nav" data-open="false" aria-hidden="true">
      <a href="index.html#products">–ü—Ä–æ–¥—É–∫—Ü—ñ—è</a>
      <a href="index.html#about">–ü—Ä–æ –ø–∞—Å—ñ–∫—É</a>
      <a href="index.html#why">–ß–æ–º—É –æ–±–∏—Ä–∞—é—Ç—å –Ω–∞—Å</a>
      <a href="reviews.html" aria-current="page">–í—ñ–¥–≥—É–∫–∏</a>
      <a class="cta" href="index.html#products">–ó–∞–º–æ–≤–∏—Ç–∏</a>
    </nav>

    <div class="nav-right">
      <span id="cartTotalHeader" class="cart-total-header" aria-hidden="true">‚Ç¥0</span>
      <button id="cartBtn" class="cart-header-btn" aria-label="–í—ñ–¥–∫—Ä–∏—Ç–∏ –∫–æ—à–∏–∫">
        üõí <span id="cartQtyBadge" class="cart-badge">0</span>
      </button>
    </div>

    <button class="menu-toggle" id="menu-toggle" aria-expanded="false" aria-controls="primary-nav">
      <span class="menu-toggle__bar"></span>
      <span class="menu-toggle__bar"></span>
      <span class="menu-toggle__bar"></span>
      <span class="visually-hidden">–ú–µ–Ω—é</span>
    </button>
  </div>
</header>

<main id="main">
  <section class="container" id="reviews">
    <h1>–í—ñ–¥–≥—É–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤</h1>
    <p class="section-subtitle">–ú–∏ —Ü—ñ–Ω—É—î–º–æ –≤–∞—à—ñ –¥—É–º–∫–∏. –û–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ –≤—ñ–¥–≥—É–∫–∞–º–∏ —ñ–Ω—à–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∞–±–æ –∑–∞–ª–∏—à—Ç–µ —Å–≤—ñ–π!</p>

    <div class="grid testimonials-grid" id="reviewsList">
      <!-- –°–µ—Ä–≤–µ—Ä–Ω—ñ –≤—ñ–¥–≥—É–∫–∏ –ø—Ä–∏—ó–¥—É—Ç—å —Å–∫—Ä–∏–ø—Ç–æ–º –Ω–∏–∂—á–µ -->
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤—ñ–¥–≥—É–∫—É -->
    <section class="card" style="margin-top:30px;">
      <h2 class="section-subtitle">–ó–∞–ª–∏—à–∏—Ç–∏ –≤—ñ–¥–≥—É–∫</h2>
      <form id="reviewForm" style="display:grid; gap:12px;">
        <div class="grid">
          <div class="col-6">
            <label for="reviewName">–í–∞—à–µ —ñ–º‚Äô—è *</label>
            <input id="reviewName" type="text" required placeholder="–Ü–º‚Äô—è" />
          </div>
          <div class="col-6">
            <label for="reviewCity">–ú—ñ—Å—Ç–æ *</label>
            <input id="reviewCity" type="text" required placeholder="–í–∞—à–µ –º—ñ—Å—Ç–æ" />
          </div>
        </div>
        <div class="col-12">
          <label for="reviewText">–í–∞—à –≤—ñ–¥–≥—É–∫ *</label>
          <textarea id="reviewText" required placeholder="–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è –≤—Ä–∞–∂–µ–Ω–Ω—è–º–∏‚Ä¶"></textarea>
        </div>
        <div style="display:flex; justify-content:flex-end;">
          <button type="submit" class="btn">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
        </div>
      </form>
    </section>
  </section>
</main>

<footer class="footer">
  <div class="container footer-grid">
    <div class="footer-brand">
      <img class="brand-wordmark" src="assets/medok-wordmark.png" alt="med_ok" width="140" height="40">
      <p class="muted">–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ —ñ–∑ —Å—ñ–º–µ–π–Ω–æ—ó –ø–∞—Å—ñ–∫–∏ –≤ –ö–∏—ó–≤—Å—å–∫—ñ–π –æ–±–ª–∞—Å—Ç—ñ. –ì–æ—Ç—É—î–º–æ –∑ –ª—é–±–æ–≤‚Äô—é —Ç–∞ —á–µ—Å–Ω—ñ—Å—Ç—é, —è–∫ –¥–ª—è —Å–µ–±–µ.</p>
      <div class="footer-tags">
        <span class="chip">40+ —Ä–æ–∫—ñ–≤ –¥–æ—Å–≤—ñ–¥—É</span>
        <span class="chip">–ë–µ–∑ –¥–æ–º—ñ—à–æ–∫</span>
        <span class="chip">–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –£–∫—Ä–∞—ó–Ω—ñ</span>
      </div>
    </div>
    <div class="footer-col">
      <h4>–®–≤–∏–¥–∫–æ –¥–æ —Ä–æ–∑–¥—ñ–ª—É</h4>
      <a href="index.html#products">üçØ –ü—Ä–æ–¥—É–∫—Ü—ñ—è</a>
      <a href="index.html#about">üêù –ü—Ä–æ –ø–∞—Å—ñ–∫—É</a>
      <a href="index.html#why">üëç –ß–æ–º—É –Ω–∞—Å –æ–±–∏—Ä–∞—é—Ç—å</a>
      <a href="reviews.html">üó£Ô∏è –í—ñ–¥–≥—É–∫–∏</a>
    </div>
    <div class="footer-col">
      <h4>–ó–≤‚Äô—è–∑–æ–∫</h4>
      <a class="footer-link" href="tel:+380632369027">üìû +380 63 236 9027</a>
      <a class="footer-link" href="viber://chat?number=%2B380632369027">üí¨ –ù–∞–ø–∏—Å–∞—Ç–∏ —É Viber</a>
      <div class="footer-badge">–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ù–æ–≤–æ—é –ø–æ—à—Ç–æ—é —â–æ–¥–Ω—è</div>
    </div>
  </div>
  <div class="container footer-bottom">
    <div>¬© <span id="y"></span> med_ok. –ù–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ –∑ –ø–∞—Å—ñ–∫–∏.</div>
    <div class="footer-bottom__right">–ë–æ—Ä–∏—Å–ø—ñ–ª—å—Å—å–∫–∏–π —Ä–∞–π–æ–Ω, –ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å.</div>
  </div>
</footer>

<script>
(function(){
  const API_BASE = 'https://medok-proxy.veter010709.workers.dev';

  const listEl = document.getElementById('reviewsList');
  const form   = document.getElementById('reviewForm');
  const nameEl = document.getElementById('reviewName');
  const cityEl = document.getElementById('reviewCity');
  const textEl = document.getElementById('reviewText');

  // admin —Ä–µ–∂–∏–º: ?admin=KEY
  const url = new URL(location.href);
  const urlAdmin = url.searchParams.get('admin');
  if (urlAdmin) localStorage.setItem('medok_admin_key', urlAdmin);
  const ADMIN_KEY = localStorage.getItem('medok_admin_key') || '';
  const isAdmin = !!ADMIN_KEY;

  const escapeHtml = (s='') => String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));

  function makeCard(r){
    const el = document.createElement('article');
    el.className = 'card';
    el.dataset.id = r.id;
    el.innerHTML = `
      <p style="margin-top:0; white-space:pre-wrap">‚Äú${escapeHtml(r.text)}‚Äù</p>
      <p class="muted">‚Äî ${escapeHtml(r.name)}, –º. ${escapeHtml(r.city)}</p>
    `;
    if (isAdmin) {
      const bar = document.createElement('div');
      bar.style.display='flex'; bar.style.gap='8px'; bar.style.marginTop='8px';
      const editBtn = Object.assign(document.createElement('button'),{type:'button',className:'btn btn-sm',textContent:'–†–µ–¥–∞–≥—É–≤–∞—Ç–∏'});
      const delBtn  = Object.assign(document.createElement('button'),{type:'button',className:'btn btn-sm btn-danger',textContent:'–í–∏–¥–∞–ª–∏—Ç–∏'});

      editBtn.onclick = async () => {
        const name = prompt('–Ü–º º—è', r.name); if (name==null) return;
        const city = prompt('–ú—ñ—Å—Ç–æ', r.city); if (city==null) return;
        const text = prompt('–í—ñ–¥–≥—É–∫', r.text); if (text==null) return;
        const ok = await apiPatch(r.id, {name,city,text});
        if (ok){ r.name=name; r.city=city; r.text=text; el.replaceWith(makeCard(r)); }
      };
      delBtn.onclick = async () => {
        if (!confirm('–¢–æ—á–Ω–æ –≤–∏–¥–∞–ª–∏—Ç–∏?')) return;
        const ok = await apiDelete(r.id);
        if (ok) el.remove();
      };
      bar.append(editBtn, delBtn);
      el.append(bar);
    }
    return el;
  }
  const prepend = r => listEl.insertBefore(makeCard(r), listEl.firstChild);

  async function apiGet(){
    const r = await fetch(`${API_BASE}/reviews`);
    const j = await r.json().catch(()=>({}));
    return j?.ok ? j.data : [];
  }
  async function apiPost(payload){
    const r = await fetch(`${API_BASE}/reviews`, {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    return r.json().catch(()=>({ok:false,error:'network'}));
  }
  async function apiPatch(id, payload){
    const r = await fetch(`${API_BASE}/reviews/${id}`, {
      method:'PATCH',
      headers:{'Content-Type':'application/json','Authorization':`Bearer ${ADMIN_KEY}`},
      body: JSON.stringify(payload)
    });
    const j = await r.json().catch(()=>({}));
    if (!r.ok || !j?.ok) { alert(j?.error || '–ü–æ–º–∏–ª–∫–∞'); return false; }
    return true;
  }
  async function apiDelete(id){
    const r = await fetch(`${API_BASE}/reviews/${id}`, {
      method:'DELETE', headers:{'Authorization':`Bearer ${ADMIN_KEY}`}
    });
    const j = await r.json().catch(()=>({}));
    if (!r.ok || !j?.ok) { alert(j?.error || '–ü–æ–º–∏–ª–∫–∞'); return false; }
    return true;
  }

  // –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É
  apiGet().then(data => data.forEach(r => prepend(r))).catch(()=>{});

  // –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º–∏
  form?.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const name = nameEl.value.trim();
    const city = cityEl.value.trim();
    const text = textEl.value.trim();
    if (!name || !city || !text) return;

    const optimistic = prepend({ id:'tmp', name, city, text });
    form.reset();

    const j = await apiPost({ name, city, text });
    if (j?.ok) optimistic.replaceWith(makeCard(j.data));
    else { optimistic.remove(); alert(j?.error || '–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—ñ–¥–≥—É–∫'); }
  });

  // —Ä—ñ–∫ —É —Ñ—É—Ç–µ—Ä—ñ
  const y = document.getElementById('y'); if (y) y.textContent = new Date().getFullYear();

  // SW
  if ('serviceWorker' in navigator) { navigator.serviceWorker.register('./sw.js').catch(()=>{}); }
})();
</script>
<script src="app.js" defer></script>
</body>
</html>