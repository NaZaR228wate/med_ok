<!doctype html>
<html lang="uk">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>–í—ñ–¥–≥—É–∫–∏ ‚Äî med_ok</title>
    <link rel="stylesheet" href="styles.css?v=14">
    <meta name="description" content="–í—ñ–¥–≥—É–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –ø—Ä–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ med_ok. –ß–∏—Ç–∞–π—Ç–µ —ñ—Å—Ç–æ—Ä—ñ—ó –Ω–∞—à–∏—Ö –ø–æ–∫—É–ø—Ü—ñ–≤ —Ç–∞ –ø–æ–¥—ñ–ª—ñ—Ç—å—Å—è –≤–ª–∞—Å–Ω–æ—é –¥—É–º–∫–æ—é!">
    <!-- Favicons and PWA -->
    <link rel="icon" href="assets/medok-wordmark.png">
    <meta name="theme-color" content="#087B04">
    <link rel="manifest" href="../../Documents/—Ä—Ä—Ä—Ä/manifest.webmanifest">
    <!-- Social preview image -->
    <meta property="og:title" content="–í—ñ–¥–≥—É–∫–∏ ‚Äî med_ok">
    <meta property="og:description" content="–î—ñ–∑–Ω–∞–π—Ç–µ—Å—è, —â–æ –≥–æ–≤–æ—Ä—è—Ç—å –∫–ª—ñ—î–Ω—Ç–∏ –ø—Ä–æ –Ω–∞—à –º–µ–¥, —Ç–∞ –∑–∞–ª–∏—à—Ç–µ —Å–≤—ñ–π –≤—ñ–¥–≥—É–∫.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="assets/prod-mixed.webp">
</head>
<body>
<a class="visually-hidden" href="#main">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É</a>

<header class="site-header">
    <div class="header-inner">
        <a href="index.html" class="header-logo" aria-label="–ù–∞ –≥–æ–ª–æ–≤–Ω—É">
            <img src="assets/medok-wordmark.png" alt="med_ok">
        </a>

        <nav class="header-nav">
            <a href="index.html#products" class="header-link">–ü—Ä–æ–¥—É–∫—Ü—ñ—è</a>
            <a href="index.html#about" class="header-link">–ü—Ä–æ –ø–∞—Å—ñ–∫—É</a>
            <a href="reviews.html" class="header-link">–í—ñ–¥–≥—É–∫–∏</a>
        </nav>

        <div class="header-actions">
            <button id="cartBtn" class="cart-icon-btn" aria-label="–ö–æ—à–∏–∫">
                üõí <span id="cartQtyBadge" class="cart-badge" style="display:none">0</span>
            </button>

            <a href="order.html" class="btn-header-cta">–ó–∞–º–æ–≤–∏—Ç–∏ –º–µ–¥</a>

            <button id="burgerBtn" class="burger-menu" aria-label="–ú–µ–Ω—é">
                <span></span><span></span><span></span>
            </button>
        </div>
    </div>
</header>

<div id="mobileBackdrop" class="mobile-nav-overlay"></div>
<div id="mobileMenu" class="mobile-nav-drawer">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <span style="font-weight:800; font-size:20px;">–ú–µ–Ω—é</span>
        <button id="closeMenuBtn" style="background:none; border:none; font-size:24px; cursor:pointer;">‚úï</button>
    </div>
    <a href="index.html#products" class="mobile-link">üçØ –ü—Ä–æ–¥—É–∫—Ü—ñ—è</a>
    <a href="index.html#about" class="mobile-link">üêù –ü—Ä–æ –ø–∞—Å—ñ–∫—É</a>
    <a href="reviews.html" class="mobile-link">üí¨ –í—ñ–¥–≥—É–∫–∏</a>
    <a href="order.html" class="btn-header-cta" style="display:block; text-align:center; margin-top:20px;">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
</div>


<!-- ===== MAIN ===== -->
<main id="main">
    <section class="container" id="reviews">
        <h1>–í—ñ–¥–≥—É–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤</h1>
        <p class="section-subtitle">–ú–∏ —Ü—ñ–Ω—É—î–º–æ –≤–∞—à—ñ –¥—É–º–∫–∏. –û–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ –≤—ñ–¥–≥—É–∫–∞–º–∏ —ñ–Ω—à–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∞–±–æ –∑–∞–ª–∏—à—Ç–µ —Å–≤—ñ–π!</p>
        <div class="grid testimonials-grid">
        </div>

        <!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤—ñ–¥–≥—É–∫—É -->
        <section class="card" style="margin-top:30px;">
            <h2 class="section-subtitle">–ó–∞–ª–∏—à–∏—Ç–∏ –≤—ñ–¥–≥—É–∫</h2>
            <form id="reviewForm" style="display:grid; gap:12px;">
                <div class="grid">
                    <div class="col-6">
                        <label for="reviewName">–í–∞—à–µ —ñ–º‚Äô—è *</label>
                        <input id="reviewName" type="text" required placeholder="–Ü–º‚Äô—è" />
                    </div>
                    <div class="col-6">
                        <label for="reviewCity">–ú—ñ—Å—Ç–æ *</label>
                        <input id="reviewCity" type="text" required placeholder="–í–∞—à–µ –º—ñ—Å—Ç–æ" />
                    </div>
                </div>
                <div class="col-12">
                    <label for="reviewText">–í–∞—à –≤—ñ–¥–≥—É–∫ *</label>
                    <textarea id="reviewText" required placeholder="–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è –≤—Ä–∞–∂–µ–Ω–Ω—è–º–∏‚Ä¶"></textarea>
                </div>
                <div style="display:flex; justify-content:flex-end;">
                    <button type="submit" class="btn">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
                </div>
            </form>
        </section>
    </section>
</main>
<section class="seo-text" style="padding:40px 20px; max-width:900px; margin:auto;">
    <h1>–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ –∑ –ø–∞—Å—ñ–∫–∏ –≤ –ë–æ—Ä–∏—Å–ø—ñ–ª—å—Å—å–∫–æ–º—É —Ä–∞–π–æ–Ω—ñ</h1>

    <p>
        –ü—Ä–æ–¥–∞—î–º–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ –∑ –≤–ª–∞—Å–Ω–æ—ó –ø–∞—Å—ñ–∫–∏ –≤ –ö–∏—ó–≤—Å—å–∫—ñ–π –æ–±–ª–∞—Å—Ç—ñ.
        –£ –Ω–∞—Å –≤–∏ –º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç–∏ –ª–∏–ø–æ–≤–∏–π, –∞–∫–∞—Ü—ñ—î–≤–∏–π —Ç–∞ —Å–æ–Ω—è—à–Ω–∏–∫–æ–≤–∏–π –º–µ–¥ –≤–∏—Å–æ–∫–æ—ó —è–∫–æ—Å—Ç—ñ.
    </p>

    <p>
        –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –ö–∏—î–≤—É, –ë–æ—Ä–∏—Å–ø—ñ–ª—å—Å—å–∫–æ–º—É —Ä–∞–π–æ–Ω—É —Ç–∞ –≤—Å—ñ–π –£–∫—Ä–∞—ó–Ω—ñ –ù–æ–≤–æ—é –ø–æ—à—Ç–æ—é.
        –ú–µ–¥ –±–µ–∑ –¥–æ–º—ñ—à–æ–∫, –∑—ñ–±—Ä–∞–Ω–∏–π –∑ –ª—é–±–æ–≤‚Äô—é —Ç–∞ –¥–æ—Å–≤—ñ–¥–æ–º.
    </p>

    <p>
        –ó–∞–º–æ–≤–ª—è–π—Ç–µ –º–µ–¥ –æ–Ω–ª–∞–π–Ω –∞–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É–π—Ç–µ ‚Äî –∑–∞–≤–∂–¥–∏ —Ä–∞–¥—ñ –Ω–æ–≤–∏–º –∫–ª—ñ—î–Ω—Ç–∞–º.
    </p>
</section>

<!-- ===== FOOTER ===== -->
<footer class="footer">
    <div class="container footer-grid">
        <div class="footer-brand">
            <img src="assets/medok-wordmark.png" alt="medok" class="footer-logo">
            <p class="muted">–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ —ñ–∑ —Å—ñ–º–µ–π–Ω–æ—ó –ø–∞—Å—ñ–∫–∏ –≤ –ö–∏—ó–≤—Å—å–∫—ñ–π –æ–±–ª–∞—Å—Ç—ñ. –ì–æ—Ç—É—î–º–æ –∑ –ª—é–±–æ–≤‚Äô—é —Ç–∞ —á–µ—Å–Ω—ñ—Å—Ç—é, —è–∫ –¥–ª—è —Å–µ–±–µ.</p>
            <div class="footer-tags">
                <span class="chip">40+ —Ä–æ–∫—ñ–≤ –¥–æ—Å–≤—ñ–¥—É</span>
                <span class="chip">–ë–µ–∑ –¥–æ–º—ñ—à–æ–∫</span>
                <span class="chip">–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –£–∫—Ä–∞—ó–Ω—ñ</span>
            </div>
        </div>
        <div class="footer-col">
            <h4>–®–≤–∏–¥–∫–æ –¥–æ —Ä–æ–∑–¥—ñ–ª—É</h4>
            <a href="index.html#products">üçØ –ü—Ä–æ–¥—É–∫—Ü—ñ—è</a>
            <a href="index.html#about">üêù –ü—Ä–æ –ø–∞—Å—ñ–∫—É</a>
            <a href="index.html#why">üëç –ß–æ–º—É –Ω–∞—Å –æ–±–∏—Ä–∞—é—Ç—å</a>
            <a href="reviews.html">üó£Ô∏è –í—ñ–¥–≥—É–∫–∏</a>
        </div>
        <div class="footer-col">
            <h4>–ó–≤‚Äô—è–∑–æ–∫</h4>
            <a class="footer-link" href="tel:+380632369027">üìû +380 63 236 9027</a>
            <a class="footer-link" href="viber://chat?number=%2B380632369027">üí¨ –ù–∞–ø–∏—Å–∞—Ç–∏ —É Viber</a>
            <div class="footer-badge">–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ù–æ–≤–æ—é –ø–æ—à—Ç–æ—é —â–æ–¥–Ω—è</div>
        </div>
    </div>
    <div class="container footer-bottom">
        <div>¬© <span id="y"></span> med_ok. –ù–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –º–µ–¥ –∑ –ø–∞—Å—ñ–∫–∏.</div>
        <div class="footer-bottom__right">–ë–æ—Ä–∏—Å–ø—ñ–ª—å—Å—å–∫–∏–π —Ä–∞–π–æ–Ω, –ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å.</div>
    </div>
</footer>

<script>
    // –ù–µ–≤–µ–ª–∏–∫–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –≤—ñ–¥–≥—É–∫—É –±–µ–∑ —Å–µ—Ä–≤–µ—Ä—É
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('reviewForm');
        const list = document.querySelector('#reviews .testimonials-grid');
        if (!form || !list) return;
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const name  = form.querySelector('#reviewName').value.trim();
            const city  = form.querySelector('#reviewCity').value.trim();
            const text  = form.querySelector('#reviewText').value.trim();
            if (!name || !city || !text) return;
            // –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –±–ª–æ–∫ –≤—ñ–¥–≥—É–∫—É
            const card = document.createElement('article');
            card.className = 'card';
            card.innerHTML = `<p>‚Äú${text}‚Äù</p><p class="muted">‚Äî ${name}, –º. ${city}</p>`;
            // –î–æ–¥–∞—î–º–æ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É
            list.insertBefore(card, list.firstChild);
            // –û—á–∏—â–∞—î–º–æ —Ñ–æ—Ä–º—É
            form.reset();
        });
    });
</script>
<script src="app.js" defer></script>
<!-- Register service worker for offline support -->
<script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js').catch(()=>{});
    }
</script>
<script>
    (() => {
        const API_BASE = 'https://medok-proxy.veter010709.workers.dev';

        // ---- –µ–ª–µ–º–µ–Ω—Ç–∏
        const listEl = document.querySelector('#reviews .testimonials-grid');
        const form   = document.getElementById('reviewForm');
        const nameEl = document.getElementById('reviewName');
        const cityEl = document.getElementById('reviewCity');
        const textEl = document.getElementById('reviewText');

        // ---- admin —Ä–µ–∂–∏–º: ?admin=KEY -> –∑–±–µ—Ä–µ–∂–µ–º–æ —É localStorage
        const url = new URL(location.href);
        const urlAdmin = url.searchParams.get('admin');
        if (urlAdmin) localStorage.setItem('medok_admin_key', urlAdmin);
        const ADMIN_KEY = localStorage.getItem('medok_admin_key') || '';

        const isAdmin = !!ADMIN_KEY;

        // ---- —É—Ç–∏–ª—ñ—Ç–∏
        function makeCard(r) {
            const el = document.createElement('article');
            el.className = 'card';
            el.dataset.id = r.id;
            el.innerHTML = `
      <p style="margin-top:0; white-space:pre-wrap">‚Äú${escapeHtml(r.text)}‚Äù</p>
      <p class="muted">‚Äî ${escapeHtml(r.name)}, –º. ${escapeHtml(r.city)}</p>
    `;
            if (isAdmin) {
                const bar = document.createElement('div');
                bar.style.display = 'flex';
                bar.style.gap = '8px';
                bar.style.marginTop = '8px';

                const editBtn = document.createElement('button');
                editBtn.type = 'button';
                editBtn.className = 'btn btn-sm';
                editBtn.textContent = '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏';

                const delBtn = document.createElement('button');
                delBtn.type = 'button';
                delBtn.className = 'btn btn-sm btn-danger';
                delBtn.textContent = '–í–∏–¥–∞–ª–∏—Ç–∏';

                editBtn.onclick = async () => {
                    const name = prompt('–Ü–º º—è', r.name);
                    if (name == null) return;
                    const city = prompt('–ú—ñ—Å—Ç–æ', r.city);
                    if (city == null) return;
                    const text = prompt('–í—ñ–¥–≥—É–∫', r.text);
                    if (text == null) return;
                    const ok = await apiPatch(r.id, { name, city, text });
                    if (ok) { r.name=name; r.city=city; r.text=text; el.replaceWith(makeCard(r)); }
                };
                delBtn.onclick = async () => {
                    if (!confirm('–¢–æ—á–Ω–æ –≤–∏–¥–∞–ª–∏—Ç–∏?')) return;
                    const ok = await apiDelete(r.id);
                    if (ok) el.remove();
                };

                bar.append(editBtn, delBtn);
                el.append(bar);
            }
            return el;
        }

        function prependCard(r) {
            const card = makeCard(r);
            listEl.insertBefore(card, listEl.firstChild);
            return card;
        }

        function escapeHtml(s='') {
            return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
        }

        // ---- API
        async function apiGet() {
            const r = await fetch(`${API_BASE}/reviews`);
            const j = await r.json(); return j?.ok ? j.data : [];
        }
        async function apiPost(payload) {
            const r = await fetch(`${API_BASE}/reviews`, {
                method:'POST', headers:{'Content-Type':'application/json'},
                body: JSON.stringify(payload)
            });
            return r.json();
        }
        async function apiPatch(id, payload) {
            const r = await fetch(`${API_BASE}/reviews/${id}`, {
                method:'PATCH',
                headers:{'Content-Type':'application/json','Authorization':`Bearer ${ADMIN_KEY}`},
                body: JSON.stringify(payload)
            });
            const j = await r.json().catch(()=>({}));
            if (!r.ok || !j?.ok) { alert(j?.error || '–ü–æ–º–∏–ª–∫–∞'); return false; }
            return true;
        }
        async function apiDelete(id) {
            const r = await fetch(`${API_BASE}/reviews/${id}`, {
                method:'DELETE',
                headers:{'Authorization':`Bearer ${ADMIN_KEY}`}
            });
            const j = await r.json().catch(()=>({}));
            if (!r.ok || !j?.ok) { alert(j?.error || '–ü–æ–º–∏–ª–∫–∞'); return false; }
            return true;
        }

        // ---- –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–∞
        (async () => {
            try {
                const data = await apiGet();
                // –ø–æ–∫–∞–∑—É—î–º–æ —Å–µ—Ä–≤–µ—Ä–Ω—ñ –≤—ñ–¥–≥—É–∫–∏ –ü–ï–†–ï–î —Å—Ç–∞—Ç–∏—á–Ω–∏–º–∏
                data.forEach(r => listEl.insertBefore(makeCard(r), listEl.firstChild));
            } catch (e) { console.warn('reviews load failed', e); }
        })();

        // ---- –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º–∏
        form?.addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = nameEl.value.trim();
            const city = cityEl.value.trim();
            const text = textEl.value.trim();
            if (!name || !city || !text) return;

            const optimistic = prependCard({ id:'tmp', name, city, text });
            form.reset();

            try {
                const j = await apiPost({ name, city, text });
                if (j?.ok) {
                    // –∑–∞–º—ñ–Ω–∏–º–æ —Ç–∏–º, —â–æ –∑ —Å–µ—Ä–≤–µ—Ä–∞ (–∑ —Ä–µ–∞–ª—å–Ω–∏–º id)
                    optimistic.replaceWith(makeCard(j.data));
                } else {
                    optimistic.remove();
                    alert(j?.error || '–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—ñ–¥–≥—É–∫');
                }
            } catch {
                optimistic.remove();
                alert('–ù–µ–º–∞—î –∑–≤ º—è–∑–∫—É. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.');
            }
        });
    })();
</script>
<script src="cart.js?v=16" defer></script>

</body>
</html>
